{"version":3,"sources":["data/caaSpain.js","exp/Exp19.js","exp/comp/Canvas.js"],"names":["cas","id","abv","sim","name","x","y","pop","test","linksId","source","target","Map","width","height","setSelected","setIsOpen","data","refSvg","useRef","radiusScale","scaleSqrt","domain","range","nodes","map","area","deaths","length","useEffect","svg","select","current","simulation","forceSimulation","force","forceLink","d","distance","strength","iterations","forceX","forceY","k","i","n","a","j","b","vx","vy","lx","Math","abs","ly","r","tick","on","rect","selectAll","enter","append","attr","style","text","total","ref","overflow","viewBox","stroke","fill","points","opacity","strokeDasharray","Tip","selected","dates","colors","isOpen","dark","useMeasure","polyfill","ResizeObserver","bounds","language","useContext","LanguageContext","isEnglish","tipAnimation","useSpring","pointerEvents","maxYScale","max","maxIndex","indexOf","maxDate","maxNumber","div","className","position","top","left","transform","zIndex","background","border","maxWidth","display","justifyContent","alignItems","borderBottom","margin","padding","fontWeight","fontSize","letterSpacing","onClick","cursor","marginLeft","xmlns","aria-hidden","strokeWidth","Date","toLocaleString","split","replace","textAlign","upd","TooltipCanvas","foreground","xScale","scaleTime","yScaleLinear","scaleLinear","TipCanvasCell","this","center","row","column","cellSize","cell","code","eu","first","ctx","areaGen","y0","curve","curveBasis","context","lineGen","line","beginPath","translate","fillStyle","bg","point","closePath","strokeStyle","main","lineWidth","xAxis","yAxis","legendLines","draw","tickCount","ticks","tickFormat","forEach","moveTo","lineTo","textBaseline","font","fillText","setLineDash","save","rotate","PI","restore","quarantine","Canvas","canvas","update","useState","setData","setDates","isLoaded","setIsLoaded","closeTip","ThemeContext","fetch","then","res","ok","Promise","reject","status","csvParse","format","reduce","acc","arr","ca","cod","key","Object","keys","values","flexDirection","canvasRef","getContext","ratio","window","devicePixelRatio","scale"],"mappings":"8MAAaA,EAAM,CACjB,CACEC,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,eACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,MACLC,IAAK,KACLC,KAAM,YACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,WACNC,EAAG,IACHC,EAAG,GACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,gBACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,WACNC,EAAG,GACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,SACLC,IAAK,KACLC,KAAM,YACNC,EAAG,IACHC,EAAG,GACHC,IAAK,OACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,SACLC,IAAK,KACLC,KAAM,qBACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,SACLC,IAAK,KACLC,KAAM,uBACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,cACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,SACLC,IAAK,KACLC,KAAM,uBACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,cACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,UACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,SACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,SACNC,EAAG,IACHC,EAAG,IACHC,IAAK,QACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,UACNC,EAAG,IACHC,EAAG,IACHC,IAAK,OACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,QACLC,IAAK,KACLC,KAAM,gBACNC,EAAG,IACHC,EAAG,GACHC,IAAK,QACLC,KAAM,MAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,WACNC,EAAG,IACHC,EAAG,IACHC,IAAK,OACLC,KAAM,KAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,QACNC,EAAG,IACHC,EAAG,IACHC,IAAK,MACLC,KAAM,GAER,CACEP,GAAI,MACJC,IAAK,OACLC,IAAK,KACLC,KAAM,UACNC,EAAG,IACHC,EAAG,IACHC,IAAK,MACLC,KAAM,IAIGC,EAAU,CACrB,CACEC,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,Q,gIC7ZNC,EAAM,SAAC,GAON,IAAD,IALJC,aAKI,MALI,IAKJ,MAJJC,cAII,MAJK,IAIL,EAHJC,EAGI,EAHJA,YACAC,EAEI,EAFJA,UACAC,EACI,EADJA,KAEMC,EAASC,mBAETC,EAAcC,cAAYC,OAAO,CAAC,EAAG,MAAQC,MAAM,CAAC,EAAG,MAEvDC,EAAQxB,EAAIyB,KAAI,SAACpB,GACrB,OAAO,eACFA,EADL,CAEEqB,KAAMN,EAAYH,EAAKZ,EAAEJ,IAAI0B,OAAOV,EAAKZ,EAAEJ,IAAI0B,OAAOC,OAAS,SAyGnE,OArGAC,qBAAU,WA2CR,IA1CA,IAAMC,EAAMC,YAAOb,EAAOc,SA6BpBC,EAAaC,YAAgBV,GAChCW,MACC,OACAC,YAAU3B,GACPR,IAAG,SAACoC,GAAD,OAAOA,EAAEpC,MACZqC,SAAS,GACTC,SAAS,OACTC,WAAW,IAEfL,MAAM,IAAKM,aAAO,SAACJ,GAAD,OAAOA,EAAEhC,KAAGkC,SAAS,KACvCJ,MAAM,IAAKO,aAAO,SAACL,GAAD,OAAOA,EAAE/B,KAAGiC,SAAS,KACvCJ,MAAM,WAtCS,WAEhB,IADA,IACSQ,EAAI,EAAmCA,EAAnB,IAAqCA,EAChE,IAAK,IAAIC,EAAI,EAAGC,EAAIrB,EAAMI,OAAQgB,EAAIC,IAAKD,EACzC,IAAK,IAAIE,EAAItB,EAAMoB,GAAIG,EAAIH,EAAI,EAAGG,EAAIF,IAAKE,EAAG,CAC5C,IAAIC,EAAIxB,EAAMuB,GACZ1C,EAAIyC,EAAEzC,EAAIyC,EAAEG,GAAKD,EAAE3C,EAAI2C,EAAEC,GACzB3C,EAAIwC,EAAExC,EAAIwC,EAAEI,GAAKF,EAAE1C,EAAI0C,EAAEE,GACzBC,EAAKC,KAAKC,IAAIhD,GACdiD,EAAKF,KAAKC,IAAI/C,GACdiD,EAAIT,EAAEpB,KAAO,EAAIsB,EAAEtB,KAAO,EATlB,GAUNyB,EAAKI,GAAKD,EAAKC,IACbJ,EAAKG,GACPH,GAAMA,EAAKI,IAAMlD,EAAI,GAXY,OAYjCyC,EAAC,IAAUK,EACXH,EAAC,IAAUG,IAEXG,GAAMA,EAAKC,IAAMjD,EAAI,GAfY,OAgBjCwC,EAAC,IAAUQ,EACXN,EAAC,IAAUM,QAqBdV,EAAI,EAAGA,EAAI,MAAOA,EACzBX,EAAWuB,OAGbvB,EAAWwB,GAAG,QAAQ,WACpB,IAAMC,EAAO5B,EACV6B,UAAU,KACV1C,KAAKO,GACLoC,QACAC,OAAO,KACPC,KAAK,aAAa,SAACzB,GAAD,0BAAoBA,EAAEhC,EAAtB,aAA4BgC,EAAE/B,EAA9B,QAGrBoD,EACGG,OAAO,QACPC,KAAK,SAAS,SAACzB,GAAD,OAAOA,EAAEX,QACvBoC,KAAK,UAAU,SAACzB,GAAD,OAAOA,EAAEX,QACxBoC,KAAK,KAAK,SAACzB,GAAD,OAAQA,EAAEX,KAAO,KAC3BoC,KAAK,KAAK,SAACzB,GAAD,OAAQA,EAAEX,KAAO,KAC3BoC,KAAK,OAAQ,2BACbA,KAAK,SAAU,2BACfC,MAAM,SAAU,WAEnBL,EAAKD,GAAG,SAAS,SAACpB,GAChBtB,EAAY,eAAKsB,EAAN,GAAYpB,EAAKoB,EAAEpC,MAC9Be,GAAU,MAIZ0C,EACGG,OAAO,QACPE,MAAM,YAFT,QAGGA,MAAM,OAAQ,2BACdA,MAAM,iBAAkB,QACxBD,KAAK,cAAe,UACpBA,KAAK,oBAAqB,UAC1BA,KAAK,MAAM,SAACzB,GACX,OAAOA,EAAEX,KAAO,IAAM,GAAK,MAG5BsC,MAAK,SAAC3B,GAAD,OAAQA,EAAEX,KAAO,GAAKW,EAAElC,IAAM,MAEtCuD,EACGG,OAAO,QACPE,MAAM,cAFT,OAGGA,MAAM,YAHT,QAIGA,MAAM,iBAAkB,QACxBA,MAAM,OAAQ,2BACdA,MAAM,UAAW,OACjBD,KAAK,cAAe,UACpBA,KAAK,KAAM,IACXA,KAAK,oBAAqB,UAC1BE,MAAK,SAAC3B,GACL,OAAOA,EAAEX,KAAO,GAAKT,EAAKoB,EAAEpC,IAAIgE,MAAQ,WAG7C,CAACzC,IAGF,oCACE,yBACE0C,IAAKhD,EACL6C,MAAO,CACLlD,MAAO,OACPsD,SAAU,WAEZC,QAAO,cAASvD,EAAT,YAAkBC,IAGzB,8BACEuD,OAAO,0BACPC,KAAK,OACLC,OAAO,wBACPR,MAAO,CAAES,QAAS,MAAOC,gBAAiB,YAO9CC,EAAM,SAAC,GAA0D,IAAD,EAAvDC,EAAuD,EAAvDA,SAAUC,EAA6C,EAA7CA,MAAOC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQ9D,EAAsB,EAAtBA,UAAW+D,EAAW,EAAXA,KAAW,EAG9CC,YAAW,CAAEC,SAAUC,MAHuB,mBAG7DhB,EAH6D,KAGxDiB,EAHwD,KAK5DC,EAAaC,qBAAWC,KAAxBF,SACFG,EAAYH,EAASG,UAErBC,EAAeC,YAAU,CAC7BjB,QAASM,EAAS,EAAI,EACtBY,cAAeZ,EAAS,OAAS,SAI7Ba,EAAYvC,KAAKwC,IAAL,MAAAxC,KAAI,YAAQuB,EAAShD,SACjCkE,EAAWlB,EAAShD,OAAOmE,QAAQH,GACnCI,EAAUnB,EAAMiB,GAChBG,EAAYrB,EAAShD,OAAOkE,GAElC,OACE,kBAAC,IAASI,IAAV,CACEC,UAAU,UACVnC,MAAK,eACAyB,EADA,CAEHW,SAAU,WACVC,IAAK,MACLC,KAAM,MACNC,UAAW,wBACXnC,SAAU,UACVoC,OAAQ,EACRC,WAAY,0BACZC,OAAQ,oCACR5F,MAAO,oBACP6F,SAAU,QACV5F,OAAQ,UAEVD,MAAK,UAnCI,GAmCJ,MACLC,OAAM,UApCG,GAoCH,MACNsD,QAAO,cArCE,GAqCF,YArCE,KAwCT,yBACEL,MAAO,CACL4C,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZ/F,OAAQ,OACRgG,aAAc,sCAGhB,uBAAG/C,MAAO,CAAEgD,OAAQ,EAAGC,QAAS,OAASd,UAAU,MAAnD,OACGvB,QADH,IACGA,OADH,EACGA,EAAUvE,KAAM,IACjB,0BACE2D,MAAO,CACLkD,WAAY,IACZC,SAAU,MACVC,cAAe,UAJnB,YAOKxC,QAPL,IAOKA,OAPL,EAOKA,EAAUxE,MAGjB,yBACEiH,QAAS,kBAAMpG,GAAW8D,IAC1Bf,OAAK,GACHsD,OAAQ,UACRvG,OAAQ,OACRwG,WAAY,OACZzG,MAAO,QAJJ,uBAKK,QALL,2BAMS,2BANT,wBAOM,QAPN,+BAQa,UARb,2BASS,UATT,IAYL,yBACE0G,MAAM,6BACN1G,MAAO,GACPC,OAAQ,GACR0G,cAAY,QAEZ,0BACElD,KAAK,0BACLmD,YAAY,IACZpD,OAAO,0BACPhC,EAAE,wGAMV,yBACE6B,IAAKA,EACLgC,UAAU,eACVnC,MAAO,CAAEgD,OAAQ,MAAOjG,OAAQ,UAEhC,yBACEoF,UAAU,YACVnC,MAAO,CACL4C,QAAS,OACTC,eAAgB,gBAChBC,WAAY,WAGd,uBAAG9C,MAAO,CAAEgD,OAAQ,EAAGC,QAAS,IAC7BzB,EAAY,aAAe,aAC5B,6BACC,IAAImC,KAAK,IAAIA,KAAK,eAChBC,eAAevC,EAASnF,IACxB2H,MAAM,KAAK,GACXC,QAAQ,IAAK,KAGlB,uBAAG9D,MAAO,CAAE+D,UAAW,SACpBvC,EAAY,UAAY,WACzB,6BACA,gCAASZ,EAASV,SAItB,kBAAC,EAAD,CACEW,MAAOA,EACP/D,MAAOsE,EAAOtE,MACdC,OAAQqE,EAAOrE,OACf6D,SAAUA,EACVE,OAAQA,EACRU,UAAWA,EACXR,KAAMA,EACNY,UAAWA,EACXE,SAAUA,EACVE,QAASA,EACTC,UAAWA,KAKf,yBAAKE,UAAU,QAAQnC,MAAO,CAAEgD,OAAQ,kBACtC,uBAAGhD,MAAO,CAAES,QAAS,MAAO0C,SAAU,QACnC3B,EAAY,UAAY,cAAe,IACvC,IAAImC,KAAK9C,EAAMmD,KACbJ,eAAevC,EAASnF,IACxB2H,MAAM,KAAK,GACXC,QAAQ,IAAK,IALlB,QAaFG,EAAgB,SAAC,GAQhB,IAPLrD,EAOI,EAPJA,SACA9D,EAMI,EANJA,MACAC,EAKI,EALJA,OACA+D,EAII,EAJJA,OACAE,EAGI,EAHJA,KACAY,EAEI,EAFJA,UACAf,EACI,EADJA,MAGMqD,EAAalD,EACf,2BACA,wBAGEgC,EAAgB,GAAhBA,EAA2B,EAA3BA,EAAoC,GAApCA,EAAgD,GAEhDmB,EAASC,cACZ7G,OAAO,CAACsD,EAAMA,MAAM,GAAIA,EAAMmD,MAC9BxG,MAAM,CAAC,EAAGV,EAAQkG,EAAeA,IAE9BqB,EAAeC,cAClB/G,OAAO,CAAC,EAAGqE,IACXpE,MAAM,CAACT,EAASiG,EAAaA,EAAe,IAEzCuB,EAjBF,WAkBF,cAA2B,IAAb3D,EAAY,EAAZA,SAAY,oBACxB4D,KAAKtI,GAAK0E,EAAS1E,GACnBsI,KAAKpC,SAAWxB,EAASwB,SACzBoC,KAAKC,OAAS7D,EAAS6D,OACvBD,KAAKE,IAAM9D,EAAS8D,IACpBF,KAAKG,OAAS/D,EAAS+D,OACvBH,KAAKI,SAAWhE,EAASgE,SACzBJ,KAAKK,KAAOjE,EAASiE,KACrBL,KAAKnI,KAAOuE,EAASvE,KACrBmI,KAAKM,KAAOlE,EAASkE,KACrBN,KAAKO,GAAKnE,EAASmE,GACnBP,KAAKQ,MAAQnE,EAAMA,MAAM,GACzB2D,KAAK5G,OAASgD,EAAShD,OA9BvB,iDAiCGqH,GACH,IAAMC,EAAUvH,cACbwH,GAAGpI,EAASiG,EAAaA,GACzBoC,MAAMC,KACNC,QAAQL,GAELM,EAAUC,cAAOF,QAAQL,GAE/BA,EAAIQ,YAEJR,EAAIS,UAAU1C,EAAaA,GAE3BiC,EAAIU,UAAY7E,EAAO8E,GAEvBV,EACEV,KAAK5G,OAAOF,KAAI,SAACmI,EAAOhH,GACtB,MAAO,CAACsF,EAAOtD,EAAMA,MAAMhC,IAAKwF,EAAawB,QAIjDZ,EAAIa,YACJb,EAAI1E,OAEJ0E,EAAIc,YAAcjF,EAAOkF,KACzBf,EAAIgB,UAAY,EAChBhB,EAAIQ,YAEJF,EACEf,KAAK5G,OAAOF,KAAI,SAACmI,EAAOhH,GACtB,MAAO,CAACsF,EAAOtD,EAAMA,MAAMhC,IAAKwF,EAAawB,QAIjDZ,EAAI3E,SAEJ2E,EAAIgB,UAAY,GAChBC,EAAMjB,GACNkB,EAAMlB,GACNmB,EAAYnB,KAvEZ,6BA0EKA,GACLT,KAAK6B,KAAKpB,KA3EV,8BA8EMA,GACNT,KAAK6B,KAAKpB,OA/EV,KAyFEiB,EAAQ,SAACjB,GACb,IAAIqB,EAAYxJ,EAAQ,IAEpByJ,EAAQpC,EAAOoC,MAAMD,GACrBE,EAAarC,EAAOqC,aAGxBvB,EAAIQ,YACJc,EAAME,SAAQ,SAAUnI,GACtB2G,EAAIyB,OAAOvC,EAAO7F,GAAIvB,EAASiG,EAAaA,GAC5CiC,EAAI0B,OAAOxC,EAAO7F,GAAIvB,EAASiG,EAAaA,EAR/B,MAUfiC,EAAIc,YAAc,OAClBd,EAAIU,UAAY,OAChBV,EAAI3E,SAEJ2E,EAAIlB,UAAY,SAChBkB,EAAI2B,aAAe,MACnB3B,EAAI4B,KAAO,aAEXN,EAAME,SAAQ,SAAUnI,GACtB2G,EAAI6B,SACFN,EAAWlI,GACX6F,EAAO7F,GACPvB,EAASiG,EAAaA,EAtBX,EAGG,OAwBdmD,EAAQ,SAAClB,GACb,IACIsB,EAAQlC,EAAakC,MADT,GAEZC,EAAanC,EAAamC,WAFd,GAIhBvB,EAAIQ,YACJc,EAAME,SAAQ,SAAUnI,GACtB2G,EAAIyB,QAAQ1D,EAAaqB,EAAa/F,IACtC2G,EAAI0B,OAAO7J,EAAQkG,EAAcA,EAAcqB,EAAa/F,OAG9D2G,EAAIU,UAAY,OAChBV,EAAIc,YAAc7B,EAClBe,EAAI8B,YAAY,CAAC,EAAG,IAEpB9B,EAAI3E,SACJ2E,EAAI8B,YAAY,IAEhB9B,EAAIlB,UAAY,OAChBkB,EAAI2B,aAAe,OACnB3B,EAAI4B,KAAO,aACXN,EAAME,SAAQ,SAAUnI,GACtB2G,EAAI6B,SAASN,EAAWlI,IAAK0E,EAAaqB,EAAa/F,GAAK,OAG9D2G,EAAI+B,OACJ/B,EAAIgC,QAAQ5H,KAAK6H,GAAK,GACtBjC,EAAIlB,UAAY,QAChBkB,EAAI2B,aAAe,MACnB3B,EAAIkC,WAGAf,EAAc,SAACnB,GAGnBA,EAAIc,YAAc7B,EAElB,IAAIkD,EAAa,IAAIzD,KAAK,cAE1BsB,EAAIQ,YACJR,EAAIyB,QAAQ1D,EAPM,GAOQA,GAC1BiC,EAAI0B,OAAOxC,EAAOiD,GARA,GAQcpE,GAChCiC,EAAI0B,OAAOxC,EAAOiD,GAAarK,EAASiG,EAAaA,GACrDiC,EAAI3E,UAGN,OACE,kBAAC+G,EAAA,EAAD,CACErH,MAAO,CACLI,SAAU,WAEZiG,KAAM,SAACiB,EAAQrC,IAtFN,SAACqC,EAAQrC,GACpB,IAAIV,EAAc,CAChB3D,aACC2G,OAAOtC,GAoFNoB,CAAKiB,EAAQrC,IAEfnI,MAAOA,EACPC,OAAQA,KAMC,qBAAO,IAAD,EACKyK,mBAAS,MADd,mBACZtK,EADY,KACNuK,EADM,OAEOD,mBAAS,MAFhB,mBAEZ3G,EAFY,KAEL6G,EAFK,OAGaF,oBAAS,GAHtB,mBAGZG,EAHY,KAGFC,EAHE,OAIaJ,mBAAS,MAJtB,mBAIZ5G,EAJY,KAIF5D,EAJE,OAKSwK,oBAAS,GALlB,mBAKZzG,EALY,KAKJ9D,EALI,KAOb4K,EAAW,WACf7K,EAAY,MACZ+D,GAAO,IAGDC,EAASM,qBAAWwG,KAApB9G,KACAK,EAAaC,qBAAWC,KAAxBF,SAKRvD,qBAAU,WAINiK,MADE,sGAECC,MAAK,SAACC,GAAD,OAAUA,EAAIC,GAAKD,EAAIhI,OAASkI,QAAQC,OAAOH,EAAII,WACxDL,MAAK,SAAC/H,GAAD,OAAUqI,YAASrI,MACxB+H,MAAK,SAAC9K,GACL,IAAMqL,EAASrL,EAAKsL,QAAO,SAACC,EAAKnM,EAAGuC,EAAG6J,GACrC,IAAMC,EAAKrM,EAAC,KACNsM,EAAMtM,EAAC,QACPuM,EAAG,WAAOD,GAKhB,UAHOtM,EAAC,YACDA,EAAC,QAEE,IAANuC,EAAS,CACX,IAAMgC,EAAQ,YAAIiI,OAAOC,KAAKzM,IAAIoB,KAAI,SAACpB,GAAD,OAAO,IAAIqH,KAAKrH,MACtDoL,EAAS,CAAE7G,QAAOmD,IAAKnD,EAAMA,EAAMhD,OAAS,KAG9C,IAAMD,EAAS,YAAIkL,OAAOE,OAAO1M,IAAIoB,KAAI,SAACpB,GAAD,OAAQA,KASjD,OAPAmM,EAAII,GAAO,CACTA,MACAD,MACAD,KACA/K,SACAsC,MAAOtC,EAAOA,EAAOC,OAAS,IAEzB4K,IACN,IAEHhB,EAAQc,GACRX,GAAY,QAKjB,IAGH,IAAM9G,EAAS,CACb8E,GAAI5E,EAAO,4BAA8B,yBACzCgF,KAAMhF,EAAO,4BAA8B,0BAG7C,OACE,yBACEhB,MAAO,CACLlD,MAAO,OACP6F,SAAU,QACVK,OAAQ,SACRjG,OAAQ,QACR6F,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZmG,cAAe,WAGhBtB,GAAYzK,GAAQ2D,GACnB,kBAAC,EAAD,CACE3D,KAAMA,EACN2K,SAAUA,EACV7K,YAAaA,EACbC,UAAWA,EACXoE,SAAUA,IAIbsG,GAAY/G,GAAYC,GACvB,kBAAC,EAAD,CACEA,MAAOA,EACPD,SAAUA,EACViH,SAAUA,EACV/G,OAAQA,EACRC,OAAQA,EACR9D,UAAWA,EACX+D,KAAMA,O,gCCnlBhB,oBAEe,gBAAsC,IAAnClE,EAAkC,EAAlCA,MAAOC,EAA2B,EAA3BA,OAAQsJ,EAAmB,EAAnBA,KAAM3D,EAAa,EAAbA,OACjCwG,EAAY9L,mBAqBhB,OAPAU,qBAAU,WACR,IAAMwJ,EAAS4B,EAAUjL,QACnBgH,EAAMqC,EAAO6B,WAAW,OAdlB,SAAC7B,EAAQrC,GACrB,IAAMmE,EAAQC,OAAOC,kBAAoB,EAEzChC,EAAOxK,MAAQA,EAAQsM,EACvB9B,EAAOvK,OAASA,EAASqM,EAEzB9B,EAAOtH,MAAMlD,MAAb,UAAwBA,EAAxB,MACAwK,EAAOtH,MAAMjD,OAAb,UAAyBA,EAAzB,MAEAkI,EAAIsE,MAAMH,EAAOA,GAMjBG,CAAMjC,EAAQrC,GACdoB,EAAKiB,EAAQrC,MAIb,4BACEjF,MAAO,CAAE0C,OAAQA,EAAS,kBAAoB,IAC9CvC,IAAK+I,EACLpM,MAAOA,EACPC,OAAQA","file":"static/js/21.77814f00.chunk.js","sourcesContent":["export const cas = [\n  {\n    id: \"c01\",\n    abv: \"And.\",\n    sim: \"AN\",\n    name: \"Andalucía\",\n    x: 321,\n    y: 571,\n    pop: 8414240,\n    test: 1375\n  },\n  {\n    id: \"c02\",\n    abv: \"Ar.\",\n    sim: \"AR\",\n    name: \"Aragón\",\n    x: 575,\n    y: 231,\n    pop: 1319291,\n    test: 848\n  },\n  {\n    id: \"c03\",\n    abv: \"Ast.\",\n    sim: \"AS\",\n    name: \"Asturias\",\n    x: 253,\n    y: 71,\n    pop: 1022800,\n    test: 307\n  },\n  {\n    id: \"c04\",\n    abv: \"Bal.\",\n    sim: \"IB\",\n    name: \"Illes Balears\",\n    x: 801,\n    y: 400,\n    pop: 1149460,\n    test: 221\n  },\n  {\n    id: \"c05\",\n    abv: \"Can.\",\n    sim: \"CN\",\n    name: \"Canarias\",\n    x: 76,\n    y: 816,\n    pop: 2153389,\n    test: 155\n  },\n  {\n    id: \"c06\",\n    abv: \"Cantb.\",\n    sim: \"CB\",\n    name: \"Cantabria\",\n    x: 367,\n    y: 71,\n    pop: 581078,\n    test: 209\n  },\n  {\n    id: \"c07\",\n    abv: \"C-L M.\",\n    sim: \"CM\",\n    name: \"Castilla y León\",\n    x: 309,\n    y: 211,\n    pop: 2399548,\n    test: 1960\n  },\n  {\n    id: \"c08\",\n    abv: \"C. y L\",\n    sim: \"CL\",\n    name: \"Castilla - La Mancha\",\n    x: 432,\n    y: 400,\n    pop: 2032863,\n    test: 2919\n  },\n  {\n    id: \"c09\",\n    abv: \"Cat.\",\n    sim: \"CT\",\n    name: \"Cataluña\",\n    x: 727,\n    y: 196,\n    pop: 7675217,\n    test: 6021\n  },\n  {\n    id: \"c10\",\n    abv: \"Com. V\",\n    sim: \"VC\",\n    name: \"Comunitat Valenciana\",\n    x: 575,\n    y: 400,\n    pop: 5003769,\n    test: 1383\n  },\n  {\n    id: \"c11\",\n    abv: \"Ext.\",\n    sim: \"EX\",\n    name: \"Extremadura\",\n    x: 225,\n    y: 400,\n    pop: 1067710,\n    test: 505\n  },\n  {\n    id: \"c12\",\n    abv: \"Gal.\",\n    sim: \"GA\",\n    name: \"Galicia\",\n    x: 121,\n    y: 119,\n    pop: 2699499,\n    test: 608\n  },\n  {\n    id: \"c13\",\n    abv: \"Mad.\",\n    sim: \"MD\",\n    name: \"Madrid\",\n    x: 384,\n    y: 312,\n    pop: 6663394,\n    test: 8931\n  },\n  {\n    id: \"c14\",\n    abv: \"Mur.\",\n    sim: \"MC\",\n    name: \"Murcia\",\n    x: 536,\n    y: 531,\n    pop: 1493898,\n    test: 149\n  },\n  {\n    id: \"c15\",\n    abv: \"Nav.\",\n    sim: \"NC\",\n    name: \"Navarra\",\n    x: 526,\n    y: 126,\n    pop: 654214,\n    test: 506\n  },\n  {\n    id: \"c16\",\n    abv: \"P. V.\",\n    sim: \"PV\",\n    name: \"País Vasco\",\n    x: 459,\n    y: 71,\n    pop: 2207776,\n    test: 1483\n  },\n  {\n    id: \"c17\",\n    abv: \"L.R.\",\n    sim: \"RI\",\n    name: \"La Rioja\",\n    x: 459,\n    y: 167,\n    pop: 316798,\n    test: 354\n  },\n  {\n    id: \"c18\",\n    abv: \"Ceu.\",\n    sim: \"CE\",\n    name: \"Ceuta\",\n    x: 266,\n    y: 703,\n    pop: 84777,\n    test: 4\n  },\n  {\n    id: \"c19\",\n    abv: \"Mel.\",\n    sim: \"ME\",\n    name: \"Melilla\",\n    x: 438,\n    y: 741,\n    pop: 86487,\n    test: 2\n  },\n];\n\nexport const linksId = [\n  {\n    source: \"c01\",\n    target: \"c11\",\n  },\n  {\n    source: \"c01\",\n    target: \"c08\",\n  },\n  {\n    source: \"c01\",\n    target: \"c14\",\n  },\n  {\n    source: \"c02\",\n    target: \"c15\",\n  },\n  {\n    source: \"c02\",\n    target: \"c09\",\n  },\n  {\n    source: \"c02\",\n    target: \"c10\",\n  },\n  {\n    source: \"c02\",\n    target: \"c08\",\n  },\n  {\n    source: \"c02\",\n    target: \"c07\",\n  },\n  {\n    source: \"c02\",\n    target: \"c17\",\n  },\n  {\n    source: \"c03\",\n    target: \"c12\",\n  },\n  {\n    source: \"c03\",\n    target: \"c07\",\n  },\n  {\n    source: \"c03\",\n    target: \"c06\",\n  },\n  {\n    source: \"c06\",\n    target: \"c03\",\n  },\n  {\n    source: \"c06\",\n    target: \"c16\",\n  },\n  {\n    source: \"c06\",\n    target: \"c07\",\n  },\n  {\n    source: \"c07\",\n    target: \"c12\",\n  },\n  {\n    source: \"c07\",\n    target: \"c03\",\n  },\n  {\n    source: \"c07\",\n    target: \"c06\",\n  },\n  {\n    source: \"c07\",\n    target: \"c16\",\n  },\n  {\n    source: \"c07\",\n    target: \"c17\",\n  },\n  {\n    source: \"c07\",\n    target: \"c02\",\n  },\n  {\n    source: \"c07\",\n    target: \"c08\",\n  },\n  {\n    source: \"c07\",\n    target: \"c13\",\n  },\n  {\n    source: \"c07\",\n    target: \"c11\",\n  },\n  {\n    source: \"c08\",\n    target: \"c13\",\n  },\n  {\n    source: \"c08\",\n    target: \"c07\",\n  },\n  {\n    source: \"c08\",\n    target: \"c02\",\n  },\n  {\n    source: \"c08\",\n    target: \"c10\",\n  },\n  {\n    source: \"c08\",\n    target: \"c14\",\n  },\n  {\n    source: \"c08\",\n    target: \"c01\",\n  },\n  {\n    source: \"c08\",\n    target: \"c11\",\n  },\n  {\n    source: \"c09\",\n    target: \"c02\",\n  },\n  {\n    source: \"c09\",\n    target: \"c11\",\n  },\n  {\n    source: \"c10\",\n    target: \"c14\",\n  },\n  {\n    source: \"c10\",\n    target: \"c08\",\n  },\n  {\n    source: \"c10\",\n    target: \"c02\",\n  },\n  {\n    source: \"c10\",\n    target: \"c09\",\n  },\n  {\n    source: \"c11\",\n    target: \"c01\",\n  },\n  {\n    source: \"c11\",\n    target: \"c07\",\n  },\n  {\n    source: \"c11\",\n    target: \"c08\",\n  },\n  {\n    source: \"c11\",\n    target: \"c14\",\n  },\n  {\n    source: \"c12\",\n    target: \"c03\",\n  },\n  {\n    source: \"c12\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c08\",\n  },\n  {\n    source: \"c13\",\n    target: \"c11\",\n  },\n  {\n    source: \"c14\",\n    target: \"c10\",\n  },\n  {\n    source: \"c14\",\n    target: \"c08\",\n  },\n  {\n    source: \"c14\",\n    target: \"c01\",\n  },\n  {\n    source: \"c15\",\n    target: \"c16\",\n  },\n  {\n    source: \"c15\",\n    target: \"c17\",\n  },\n  {\n    source: \"c15\",\n    target: \"c02\",\n  },\n  {\n    source: \"c16\",\n    target: \"c06\",\n  },\n  {\n    source: \"c16\",\n    target: \"c07\",\n  },\n  {\n    source: \"c16\",\n    target: \"c17\",\n  },\n  {\n    source: \"c16\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c07\",\n  },\n  {\n    source: \"c17\",\n    target: \"c16\",\n  },\n  {\n    source: \"c17\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c02\",\n  },\n];\n\n// export const popTotal = 47026208;\n// https://www.ine.es/jaxiT3/Datos.htm?t=2915#!tabs-tabla\n","import React, { useEffect, useState, useRef, useContext } from \"react\";\n// Data\nimport { cas, linksId } from \"../data/caaSpain\";\n// D3\nimport { select } from \"d3-selection\";\nimport { forceX, forceY, forceSimulation, forceLink } from \"d3-force\";\nimport { scaleSqrt, scaleLinear, scaleTime } from \"d3-scale\";\nimport { area, line, curveBasis } from \"d3-shape\";\nimport { csvParse } from \"d3-dsv\";\n// Etc\nimport useMeasure from \"react-use-measure\";\nimport { ResizeObserver } from \"@juggle/resize-observer\";\nimport { animated, useSpring } from \"react-spring\";\nimport ThemeContext from \"../context/ThemeContext\";\nimport LanguageContext from \"../context/LanguageContext\";\n// Comp\nimport Canvas from \"./comp/Canvas\";\n\n// MAP\nconst Map = ({\n  // ignore-prettier\n  width = 900,\n  height = 900,\n  setSelected,\n  setIsOpen,\n  data,\n}) => {\n  const refSvg = useRef();\n\n  const radiusScale = scaleSqrt().domain([0, 10000]).range([5, 310]);\n\n  const nodes = cas.map((x) => {\n    return {\n      ...x,\n      area: radiusScale(data[x.id].deaths[data[x.id].deaths.length - 1]),\n    };\n  });\n\n  useEffect(() => {\n    const svg = select(refSvg.current);\n\n    const collision = () => {\n      const padding = 10;\n      for (let k = 0, iterations = 4, strength = 0.5; k < iterations; ++k) {\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n          for (let a = nodes[i], j = i + 1; j < n; ++j) {\n            let b = nodes[j],\n              x = a.x + a.vx - b.x - b.vx,\n              y = a.y + a.vy - b.y - b.vy,\n              lx = Math.abs(x),\n              ly = Math.abs(y),\n              r = a.area / 2 + b.area / 2 + padding;\n            if (lx < r && ly < r) {\n              if (lx > ly) {\n                lx = (lx - r) * (x < 0 ? -strength : strength);\n                a[\"vx\"] -= lx;\n                b[\"vx\"] += lx;\n              } else {\n                ly = (ly - r) * (y < 0 ? -strength : strength);\n                a[\"vy\"] -= ly;\n                b[\"vy\"] += ly;\n              }\n            }\n          }\n        }\n      }\n    };\n\n    const simulation = forceSimulation(nodes)\n      .force(\n        \"link\",\n        forceLink(linksId)\n          .id((d) => d.id)\n          .distance(0)\n          .strength(0.0025)\n          .iterations(6)\n      )\n      .force(\"x\", forceX((d) => d.x).strength(0.1))\n      .force(\"y\", forceY((d) => d.y).strength(0.1))\n      .force(\"collide\", collision);\n\n    for (let i = 0; i < 120; ++i) {\n      simulation.tick();\n    }\n\n    simulation.on(\"tick\", () => {\n      const rect = svg\n        .selectAll(\"g\")\n        .data(nodes)\n        .enter()\n        .append(\"g\")\n        .attr(\"transform\", (d) => `translate(${d.x}, ${d.y})`);\n\n      // Rect\n      rect\n        .append(\"rect\")\n        .attr(\"width\", (d) => d.area)\n        .attr(\"height\", (d) => d.area)\n        .attr(\"x\", (d) => -d.area / 2)\n        .attr(\"y\", (d) => -d.area / 2)\n        .attr(\"fill\", \"var(--background-color)\")\n        .attr(\"stroke\", \"var(--foreground-color)\")\n        .style(\"cursor\", \"pointer\");\n\n      rect.on(\"click\", (d) => {\n        setSelected({ ...d, ...data[d.id] });\n        setIsOpen(true);\n      });\n\n      // Text\n      rect\n        .append(\"text\")\n        .style(\"font-size\", `18px`)\n        .style(\"fill\", \"var(--foreground-color)\")\n        .style(\"pointer-events\", \"none\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"middle\")\n        .attr(\"dy\", (d) => {\n          return d.area > 90 ? -15 : \"\";\n        })\n\n        .text((d) => (d.area > 30 ? d.sim : \"\"));\n\n      rect\n        .append(\"text\")\n        .style(\"font-weight\", `700`)\n        .style(\"font-size\", `21px`)\n        .style(\"pointer-events\", \"none\")\n        .style(\"fill\", \"var(--foreground-color)\")\n        .style(\"opacity\", \"0.5\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dy\", 15)\n        .attr(\"dominant-baseline\", \"middle\")\n        .text((d) => {\n          return d.area > 90 ? data[d.id].total : \"\";\n        });\n    });\n  }, [nodes]);\n\n  return (\n    <>\n      <svg\n        ref={refSvg}\n        style={{\n          width: \"100%\",\n          overflow: \"visible\",\n        }}\n        viewBox={`0 0 ${width} ${height}`}\n      >\n        {/* Canarias */}\n        <polyline\n          stroke=\"var(--foreground-color)\"\n          fill=\"none\"\n          points=\"0,745 175,745 175,900\"\n          style={{ opacity: \"0.5\", strokeDasharray: \"4 2\" }}\n        />\n      </svg>\n    </>\n  );\n};\n\nconst Tip = ({ selected, dates, colors, isOpen, setIsOpen, dark }) => {\n  const size = 50;\n\n  const [ref, bounds] = useMeasure({ polyfill: ResizeObserver });\n\n  const { language } = useContext(LanguageContext);\n  const isEnglish = language.isEnglish;\n\n  const tipAnimation = useSpring({\n    opacity: isOpen ? 1 : 0,\n    pointerEvents: isOpen ? \"auto\" : \"none\",\n  });\n\n  // Data\n  const maxYScale = Math.max(...selected.deaths);\n  const maxIndex = selected.deaths.indexOf(maxYScale);\n  const maxDate = dates[maxIndex];\n  const maxNumber = selected.deaths[maxIndex];\n\n  return (\n    <animated.div\n      className=\"tooltip\"\n      style={{\n        ...tipAnimation,\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%)\",\n        overflow: \"visible\",\n        zIndex: 2,\n        background: \"var(--background-color)\",\n        border: \"1px solid var(--foreground-color)\",\n        width: \"calc(100% - 60px)\",\n        maxWidth: \"800px\",\n        height: \"500px\",\n      }}\n      width={`${size}px`}\n      height={`${size}px`}\n      viewBox={`0 0 ${size} ${size}`}\n    >\n      {/* Header */}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          height: \"50px\",\n          borderBottom: \"1px solid var(--foreground-color)\",\n        }}\n      >\n        <p style={{ margin: 0, padding: \"1em\" }} className=\"h4\">\n          {selected?.name}{\" \"}\n          <span\n            style={{\n              fontWeight: 400,\n              fontSize: \"85%\",\n              letterSpacing: \"0.1em\",\n            }}\n          >\n            | {selected?.sim}\n          </span>\n        </p>\n        <div\n          onClick={() => setIsOpen(!isOpen)}\n          style={{\n            cursor: \"pointer\",\n            height: \"100%\",\n            marginLeft: \"auto\",\n            width: \"50px\",\n            height: \"50px\",\n            background: \"var(--foreground-color)\",\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width={32}\n            height={32}\n            aria-hidden=\"true\"\n          >\n            <path\n              fill=\"var(--background-color)\"\n              strokeWidth=\"1\"\n              stroke=\"var(--background-color)\"\n              d=\"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4l6.6 6.6L8 22.6 9.4 24l6.6-6.6 6.6 6.6 1.4-1.4-6.6-6.6L24 9.4z\"\n            />\n          </svg>\n        </div>\n      </div>\n      {/* Canvas */}\n      <div\n        ref={ref}\n        className=\"tooltipGraph\"\n        style={{ margin: \"1em\", height: \"340px\" }}\n      >\n        <div\n          className=\"keyCanvas\"\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n          }}\n        >\n          <p style={{ margin: 0, padding: 0 }}>\n            {isEnglish ? \"Quarantine\" : \"Cuarentena\"}\n            <br />\n            {new Date(new Date(\"2020-03-15\"))\n              .toLocaleString(language.id)\n              .split(\" \")[0]\n              .replace(\",\", \"\")}\n          </p>\n\n          <p style={{ textAlign: \"left\" }}>\n            {isEnglish ? \"Deaths:\" : \"Muertes:\"}\n            <br />\n            <strong>{selected.total}</strong>\n          </p>\n        </div>\n\n        <TooltipCanvas\n          dates={dates}\n          width={bounds.width}\n          height={bounds.height}\n          selected={selected}\n          colors={colors}\n          isEnglish={isEnglish}\n          dark={dark}\n          maxYScale={maxYScale}\n          maxIndex={maxIndex}\n          maxDate={maxDate}\n          maxNumber={maxNumber}\n        />\n      </div>\n\n      {/* Notes */}\n      <div className=\"notes\" style={{ margin: \"3em 1em 0 1em\" }}>\n        <p style={{ opacity: \"0.5\", fontSize: \"90%\" }}>\n          {isEnglish ? \"Updated\" : \"Actualizado\"}{\" \"}\n          {new Date(dates.upd)\n            .toLocaleString(language.id)\n            .split(\" \")[0]\n            .replace(\",\", \"\")}\n          .\n        </p>\n      </div>\n    </animated.div>\n  );\n};\n\nconst TooltipCanvas = ({\n  selected,\n  width,\n  height,\n  colors,\n  dark,\n  maxYScale,\n  dates,\n}) => {\n  // color\n  const foreground = dark\n    ? \"RGBA(255, 255, 255, 0.8)\"\n    : \"RGBA(26, 27, 30, 0.6)\";\n\n  // d3\n  const margin = { top: 50, right: 0, left: 50, bottom: 40 };\n\n  const xScale = scaleTime()\n    .domain([dates.dates[0], dates.upd])\n    .range([0, width - margin.right - margin.left]);\n\n  const yScaleLinear = scaleLinear()\n    .domain([0, maxYScale])\n    .range([height - margin.top - margin.bottom, 0]);\n\n  class TipCanvasCell {\n    constructor({ selected }) {\n      this.id = selected.id;\n      this.position = selected.position;\n      this.center = selected.center;\n      this.row = selected.row;\n      this.column = selected.column;\n      this.cellSize = selected.cellSize;\n      this.cell = selected.cell;\n      this.name = selected.name;\n      this.code = selected.code;\n      this.eu = selected.eu;\n      this.first = dates.dates[0];\n      this.deaths = selected.deaths;\n    }\n\n    draw(ctx) {\n      const areaGen = area()\n        .y0(height - margin.top - margin.bottom)\n        .curve(curveBasis)\n        .context(ctx);\n\n      const lineGen = line().context(ctx);\n\n      ctx.beginPath();\n\n      ctx.translate(margin.left, margin.top);\n\n      ctx.fillStyle = colors.bg;\n\n      areaGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.closePath();\n      ctx.fill();\n\n      ctx.strokeStyle = colors.main;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n\n      lineGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.stroke();\n\n      ctx.lineWidth = 0.5;\n      xAxis(ctx);\n      yAxis(ctx);\n      legendLines(ctx);\n    }\n\n    update(ctx) {\n      this.draw(ctx);\n    }\n\n    animate(ctx) {\n      this.draw(ctx);\n    }\n  }\n\n  const draw = (canvas, ctx) => {\n    new TipCanvasCell({\n      selected,\n    }).update(ctx);\n  };\n\n  const xAxis = (ctx) => {\n    let tickCount = width / 150;\n    let tickSize = 6;\n    let ticks = xScale.ticks(tickCount);\n    let tickFormat = xScale.tickFormat();\n    let tickPadding = 7;\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(xScale(d), height - margin.top - margin.bottom);\n      ctx.lineTo(xScale(d), height - margin.top - margin.bottom + tickSize);\n    });\n    ctx.strokeStyle = \"gray\";\n    ctx.fillStyle = \"gray\";\n    ctx.stroke();\n\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    ctx.font = \"12px Inter\";\n\n    ticks.forEach(function (d) {\n      ctx.fillText(\n        tickFormat(d),\n        xScale(d),\n        height - margin.top - margin.bottom + tickSize + tickPadding\n      );\n    });\n  };\n\n  const yAxis = (ctx) => {\n    let tickCount = 5;\n    let ticks = yScaleLinear.ticks(tickCount);\n    let tickFormat = yScaleLinear.tickFormat(tickCount);\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(-margin.left, yScaleLinear(d));\n      ctx.lineTo(width - margin.left - margin.right, yScaleLinear(d));\n    });\n\n    ctx.fillStyle = \"gray\";\n    ctx.strokeStyle = foreground;\n    ctx.setLineDash([2, 1]);\n\n    ctx.stroke();\n    ctx.setLineDash([]);\n\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"left\";\n    ctx.font = \"12px Inter\";\n    ticks.forEach(function (d) {\n      ctx.fillText(tickFormat(d), -margin.left, yScaleLinear(d) - 20);\n    });\n\n    ctx.save();\n    ctx.rotate(-Math.PI / 2);\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"top\";\n    ctx.restore();\n  };\n\n  const legendLines = (ctx) => {\n    const legendTop = 10;\n\n    ctx.strokeStyle = foreground;\n\n    let quarantine = new Date(\"2020-03-15\");\n\n    ctx.beginPath();\n    ctx.moveTo(-margin.left, -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), height - margin.top - margin.bottom);\n    ctx.stroke();\n  };\n\n  return (\n    <Canvas\n      style={{\n        overflow: \"visible\",\n      }}\n      draw={(canvas, ctx) => {\n        draw(canvas, ctx);\n      }}\n      width={width}\n      height={height}\n    />\n  );\n};\n\n// MAIN\nexport default () => {\n  const [data, setData] = useState(null);\n  const [dates, setDates] = useState(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [selected, setSelected] = useState(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const closeTip = () => {\n    setSelected(null);\n    isOpen(false);\n  };\n\n  const { dark } = useContext(ThemeContext);\n  const { language } = useContext(LanguageContext);\n\n  // DATA\n  // Force\n\n  useEffect(() => {\n    const fetchData = () => {\n      const uri =\n        \"https://raw.githubusercontent.com/datadista/datasets/master/COVID%2019/ccaa_covid19_fallecidos.csv\";\n      fetch(uri)\n        .then((res) => (res.ok ? res.text() : Promise.reject(res.status)))\n        .then((text) => csvParse(text))\n        .then((data) => {\n          const format = data.reduce((acc, x, i, arr) => {\n            const ca = x[\"CCAA\"];\n            const cod = x[\"cod_ine\"];\n            const key = `c${cod}`;\n            // delete\n            delete x[\"CCAA\"];\n            delete x[\"cod_ine\"];\n            // save dates\n            if (i === 0) {\n              const dates = [...Object.keys(x)].map((x) => new Date(x));\n              setDates({ dates, upd: dates[dates.length - 1] });\n            }\n            // array\n            const deaths = [...Object.values(x)].map((x) => +x);\n\n            acc[key] = {\n              key,\n              cod,\n              ca,\n              deaths,\n              total: deaths[deaths.length - 1],\n            };\n            return acc;\n          }, {});\n          // save data\n          setData(format);\n          setIsLoaded(true);\n        });\n    };\n\n    fetchData();\n  }, []);\n\n  // Colors\n  const colors = {\n    bg: dark ? \"RGBA(234, 234, 234, 0.20)\" : \"RGBA(26, 27, 30, 0.10)\",\n    main: dark ? \"RGBA(234, 234, 234, 1.00)\" : \"RGBA(26, 27, 30, 1.00)\",\n  };\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        maxWidth: \"600px\",\n        margin: \"0 auto\",\n        height: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        flexDirection: \"column\",\n      }}\n    >\n      {isLoaded && data && dates && (\n        <Map\n          data={data}\n          closeTip={closeTip}\n          setSelected={setSelected}\n          setIsOpen={setIsOpen}\n          language={language}\n        />\n      )}\n\n      {isLoaded && selected && dates && (\n        <Tip\n          dates={dates}\n          selected={selected}\n          closeTip={closeTip}\n          colors={colors}\n          isOpen={isOpen}\n          setIsOpen={setIsOpen}\n          dark={dark}\n        />\n      )}\n    </div>\n  );\n};\n","import React, { useRef, useEffect } from \"react\";\n\nexport default ({ width, height, draw, border }) => {\n  let canvasRef = useRef();\n\n  const scale = (canvas, ctx) => {\n    const ratio = window.devicePixelRatio || 1;\n\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    ctx.scale(ratio, ratio);\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    scale(canvas, ctx);\n    draw(canvas, ctx);\n  });\n\n  return (\n    <canvas\n      style={{ border: border ? \"1px solid white\" : \"\" }}\n      ref={canvasRef}\n      width={width}\n      height={height}\n    />\n  );\n};\n"],"sourceRoot":""}